<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Ch·∫•t L∆∞·ª£ng S·∫£n Xu·∫•t</title>
<style>
  body { font-family: Arial; text-align: center; background: #f9f9f9; margin: 0; }
  #gameContainer { margin-top: 20px; }
  img { width: 300px; height: auto; border-radius: 12px; box-shadow: 0 0 10px #ccc; }
  button { margin: 10px; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; }
  .btnStart { background-color: #4CAF50; color: white; }
  .btnSelect { background-color: #2196F3; color: white; }
  #ranking { margin-top: 20px; text-align: left; width: 320px; margin: auto; background: #fff; padding: 10px; border-radius: 10px; box-shadow: 0 0 8px #ccc; }
</style>
</head>
<body>

<h2>üéØ Game Nh·∫≠n Di·ªán L·ªói Ch·∫•t L∆∞·ª£ng</h2>
<p>Ch·ªçn m·ª•c ch∆°i:</p>
<button class="btnSelect" onclick="selectMode('S·∫£n ph·∫©m')">S·∫£n ph·∫©m</button>
<button class="btnSelect" onclick="selectMode('Bao b√¨ c·∫•p 1')">Bao b√¨ c·∫•p 1</button>
<button class="btnSelect" onclick="selectMode('Bao b√¨ c·∫•p 2')">Bao b√¨ c·∫•p 2</button>

<div id="gameContainer"></div>
<div id="ranking"></div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwPk5W-ScPVO35tICUzzhDqDsEr7nPy8fxnjhAzOUIo3lOwdo8n3J4jiDOFaO2o2TOc/exec";
const imageBase = "https://lehienbqc53-cpu.github.io/Mygame/Anh/"; // ƒê√∫ng th∆∞ m·ª•c ·∫£nh c·ªßa b·∫°n
let currentMode = "";
let score = 0;
let timer;
let timeLeft = 20;
let images = {};

images["S·∫£n ph·∫©m"] = [
  "Banh_Be_Vo.webp","Banh_Dat1.webp","Banh_Khuyet.webp","Banh_Loi_Cong_Dau.webp",
  "Banh_Loi_Dinh_Nhau.webp","Banh_Loi_Khong_Dau.webp","Banh_Mau_Sac_Khong_Dat.webp",
  "Banh_Rop_Mat.webp","Banh_Sut_Mat_Mieng.webp","Banh_Dat2.webp"
];

images["Bao b√¨ c·∫•p 1"] = [
  "Sai_Date_Code.webp","Bang_Keo_Noi_Cuon.webp","Can_Trang.webp","Duong_Han_Bi_Hu_Hai.webp",
  "Duong_Han_Can_Rach.webp","Duong_Han_Qua_Nhiet.webp","Duong_Han_Yeu.webp","Xep_Ly.webp",
  "Xep_Ly_xi.webp","Kep_Banh_Duong_Han.webp","Lech_Bao_Bi.webp"
];

images["Bao b√¨ c·∫•p 2"] = [
  "Bang_Keo_Nhan_Khong_Du_chieu_dai.webp","Hop_Bung_Keo.webp","Hop_Dan_Tho_Tai.webp","Hop_Lem_Keo.webp",
  "Khe_Ho_Nap_Thung.webp","Lech_Nap_Thung.webp","Mop_Gay_Hop.webp","Rach_Goc_Hop.webp",
  "Sai_Date_Code.webp","Sai_Date_Thung.webp","Sai_Quy_Cach_Xep.webp","Thieu_Banh.webp",
  "Thieu_Thung_Tren_Palet.webp","Thung_Mop_Meo.webp","Tray_Xuoc_Hop.webp","Hop_Bi_Ho.webp","Dan_Lech.webp"
];

function selectMode(mode) {
  currentMode = mode;
  score = 0;
  timeLeft = 20;
  document.getElementById("gameContainer").innerHTML = `
    <h3>Ch·∫ø ƒë·ªô: ${mode}</h3>
    <p id="timer">‚è±Ô∏è 20 gi√¢y</p>
    <img id="img" src="">
    <p><button class="btnStart" onclick="startGame()">B·∫Øt ƒë·∫ßu</button></p>
    <p>ƒêi·ªÉm: <span id="score">0</span></p>
  `;
}

function startGame() {
  const imgElement = document.getElementById("img");
  showRandomImage(imgElement);

  timer = setInterval(() => {
    timeLeft--;
    document.getElementById("timer").textContent = `‚è±Ô∏è ${timeLeft} gi√¢y`;
    if (timeLeft <= 0) {
      clearInterval(timer);
      endGame();
    }
  }, 1000);
}

function showRandomImage(imgElement) {
  const arr = images[currentMode];
  let index = Math.floor(Math.random() * arr.length);
  const ts = new Date().getTime();
  imgElement.src = imageBase + arr[index] + "?v=" + ts;

  imgElement.onclick = () => {
    score++;
    document.getElementById("score").textContent = score;
    showRandomImage(imgElement);
  };
}

function endGame() {
  const ten = prompt("üéâ Nh·∫≠p t√™n c·ªßa b·∫°n ƒë·ªÉ l∆∞u k·∫øt qu·∫£:");
  if (!ten) return;
  fetch(SCRIPT_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ action: "save", ten_nguoi_choi: ten, muc_choi: currentMode, diem: score })
  })
  .then(() => {
    alert("‚úÖ K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c l∆∞u!");
    showRanking();
  })
  .catch(err => alert("‚ùå L·ªói l∆∞u d·ªØ li·ªáu: " + err));
}

function showRanking() {
  fetch(`${SCRIPT_URL}?action=getRanking`)
    .then(res => res.json())
    .then(data => {
      let html = "<h3>üèÜ B·∫£ng x·∫øp h·∫°ng</h3><ol>";
      data.forEach(p => { html += `<li>${p.name} (${p.mode}) ‚Äî ${p.score} ƒëi·ªÉm</li>`; });
      html += "</ol>";
      document.getElementById("ranking").innerHTML = html;
    })
    .catch(() => {
      document.getElementById("ranking").innerHTML = "<p>L·ªói t·∫£i b·∫£ng x·∫øp h·∫°ng.</p>";
    });
}
</script>
</body>
</html>

