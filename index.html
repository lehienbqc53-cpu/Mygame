<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LƒÉng k√≠nh ng∆∞·ªùi ti√™u d√πng</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; text-align: center; }
    h1 { color: #6c3; }
    #menu button { margin: 10px; padding: 10px 20px; font-size: 16px; }
    #game img { width: 300px; height: 300px; object-fit: contain; margin-top: 20px; }
    #result { font-size: 20px; color: #333; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>üéØ LƒÉng k√≠nh ng∆∞·ªùi ti√™u d√πng</h1>
  <div id="menu">
    <button onclick="startGame('product')">S·∫£n ph·∫©m</button>
    <button onclick="startGame('pack1')">Bao b√¨ c·∫•p 1</button>
    <button onclick="startGame('pack2')">Bao b√¨ c·∫•p 2</button>
  </div>
  
  <div id="game" style="display:none;">
    <h2 id="modeName"></h2>
    <img id="image" src="" alt="L·ªói" />
    <div id="timer">‚è±Ô∏è Th·ªùi gian: 20s</div>
    <div id="score">ƒêi·ªÉm: 0</div>
    <button onclick="nextImage()">·∫¢nh ti·∫øp theo</button>
    <div id="result"></div>
  </div>

  <button id="saveBtn" style="display:none;" onclick="exportToExcel()">üíæ L∆∞u k·∫øt qu·∫£ Excel</button>

  <script>
    const product = [
      "Banh_Be_Vo.webp","Banh_Dat1.webp","Banh_Khuyet.webp","Banh_Loi_Cong_Dau.webp","Banh_Loi_Dinh_Nhau.webp",
      "Banh_Loi_Khong_Dau.webp","Banh_Mau_Sac_Khong_Dat.webp","Banh_Rop_Mat.webp","Banh_Sut_Mat_Mieng.webp","Banh_Dat2.webp"
    ];

    const pack1 = [
      "Sai_Date_Code.webp","Bang_Keo_Noi_Cuon.webp","Can_Trang.webp","Duong_Han_Bi_Hu_Hai.webp","Duong_Han_Can_Rach.webp",
      "Duong_Han_Qua_Nhiet.webp","Duong_Han_Yeu.webp","Xep_Ly.webp","Xep_Ly_xi.webp","Kep_Banh_Duong_Han.webp","Lech_Bao_Bi.webp"
    ];

    const pack2 = [
      "Bang_Keo_Nhan_Khong_Du_chieu_dai.webp","Hop_Bung_Keo.webp","Hop_Dan_Tho_Tai.webp","Hop_Lem_Keo.webp","Khe_Ho_Nap_Thung.webp",
      "Lech_Nap_Thung.webp","Mop_Gay_Hop.webp","Rach_Goc_Hop.webp","Sai_Date_Code.webp","Sai_Date_Thung.webp","Sai_Quy_Cach_Xep.webp",
      "Thieu_Banh.webp","Thieu_Thung_Tren_Palet.webp","Thung_Mop_Meo.webp","Tray_Xuoc_Hop.webp","Hop_Bi_Ho.webp","Dan_Lech.webp"
    ];

    let currentMode = "";
    let score = 0;
    let index = 0;
    let timer = 20;
    let countdown;
    let gameData = [];

    function startGame(mode) {
      currentMode = mode;
      score = 0;
      index = 0;
      timer = 20;
      document.getElementById("menu").style.display = "none";
      document.getElementById("game").style.display = "block";
      document.getElementById("saveBtn").style.display = "none";
      document.getElementById("result").innerText = "";
      document.getElementById("score").innerText = "ƒêi·ªÉm: 0";
      document.getElementById("modeName").innerText =
        mode === "product" ? "S·∫£n ph·∫©m" :
        mode === "pack1" ? "Bao b√¨ c·∫•p 1" : "Bao b√¨ c·∫•p 2";
      showImage();
      countdown = setInterval(updateTimer, 1000);
    }

    function updateTimer() {
      timer--;
      document.getElementById("timer").innerText = `‚è±Ô∏è Th·ªùi gian: ${timer}s`;
      if (timer <= 0) endGame();
    }

    function showImage() {
      const folder = "images/Anh/";
      const list = currentMode === "product" ? product : currentMode === "pack1" ? pack1 : pack2;
      if (index >= list.length) return endGame();
      document.getElementById("image").src = folder + list[index];
    }

    function nextImage() {
      score += 1;
      document.getElementById("score").innerText = `ƒêi·ªÉm: ${score}`;
      index++;
      showImage();
    }

    function endGame() {
      clearInterval(countdown);
      document.getElementById("result").innerText = `üéâ Ho√†n th√†nh! T·ªïng ƒëi·ªÉm: ${score}`;
      document.getElementById("saveBtn").style.display = "block";
      gameData.push({
        CheDo: document.getElementById("modeName").innerText,
        Diem: score,
        ThoiGian: new Date().toLocaleString()
      });
    }

    function exportToExcel() {
      const ws = XLSX.utils.json_to_sheet(gameData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "KetQua");
      XLSX.writeFile(wb, "KetQua_Choi_Game.xlsx");
      alert("‚úÖ K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c t·∫£i xu·ªëng file Excel!");
    }
  </script>
</body>
</html>
